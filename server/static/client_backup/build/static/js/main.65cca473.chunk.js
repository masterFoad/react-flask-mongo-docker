(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){},167:function(e,t,a){e.exports=a(305)},175:function(e,t,a){},176:function(e,t,a){},181:function(e,t,a){},203:function(e,t,a){},204:function(e,t,a){},304:function(e,t,a){},305:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(14),r=a(22),l=a(31),s=function(e){return{type:"LOADING",status:e}},c=function(e){return{type:"SHOW_DIALOG",dialog:e}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING":return Object.assign({},e,{isLoading:t.status});case"SERVER_ERROR":return Object.assign({},e,{error:"server error, please try again\n"+t.error});case"SHOW_DIALOG":return Object.assign({},e,{dialog:t.dialog});default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{imageToUpload:[],jsonToUpload:{},title:"",description:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPLOAD_IMAGE":return Object.assign({},e,{imageToUpload:t.data});case"UPLOAD_JSON":return Object.assign({},e,{jsonToUpload:t.data});case"INPUT_TITLE":return Object.assign({},e,{title:t.data});case"INPUT_DESCRIPTION":return Object.assign({},e,{description:t.data});case"UPLOAD_DATA_TO_SERVER":return{imageToUpload:[],jsonToUpload:{},title:"",description:""};default:return e}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{imagesCache:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CACHE":return Object.assign({},e,{imagesCache:t.imagesCache});default:return e}},m=Object(l.c)({appState:p,uploadState:d,galleryState:u}),g=a(150),h=(a(175),a(176),a(112)),f=a.n(h),b=a(151),v=a(7),E=a(8),O=a(11),C=a(12),j=a(339),y=a(340),k=a(348),w=a(152),D=a.n(w),T=function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).onDrop=function(e){n.props.onImageUpload(e)},n}return Object(E.a)(a,[{key:"render",value:function(){return o.a.createElement(D.a,{withIcon:!1,buttonText:"Choose images",onChange:this.onDrop,imgExtension:[".jpg",".png",".jpeg"],withPreview:!0,singleImage:!0})}}]),a}(o.a.Component),N=Object(r.b)(function(e){var t=e.uploadState,a=e.appState;return{imageToUpload:t.imageToUpload,isCurrentlyLoading:a.isLoading}},function(e){return{onImageUpload:function(t){e({type:"UPLOAD_IMAGE",data:t})}}})(T),U=(a(120),function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).onFileChange=function(e){n.props.onJsonUpload(e.target.files[0])},n.fileData=function(){if(n.props.jsonToUpload.selectedFile)return o.a.createElement("div",null,o.a.createElement("h2",null,"File Details:"),o.a.createElement("p",null,"File Name: ",n.props.jsonToUpload.selectedFile.name),o.a.createElement("p",null,"Last Modified:"," ",n.props.jsonToUpload.selectedFile.lastModifiedDate.toDateString()))},n}return Object(E.a)(a,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("p",{className:"upload_label"},"Choose test case json"),o.a.createElement("div",null,o.a.createElement("label",{style:{padding:"6px 23px",background:"#3f4257",borderRadius:"30px",color:"white",fontWeight:300,fontSize:14,margin:"10px 0",transition:"all 0.2s ease-in",cursor:"pointer",outline:"none"}},o.a.createElement("input",{type:"file",accept:".json",onChange:this.onFileChange}))),this.fileData())}}]),a}(n.Component)),S=Object(r.b)(function(e){var t=e.uploadState,a=e.appState;return{jsonToUpload:t.jsonToUpload,isCurrentlyLoading:a.isLoading}},function(e){return{onJsonUpload:function(t){e({type:"UPLOAD_JSON",data:t})}}})(U),_=a(338),L=a(306),I=a(153),x=a.n(I),A=function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).handleTextChange=function(e,t){t(e.target.value)},n.uploadAllDetails=Object(b.a)(f.a.mark(function e(){var t,a,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.props.setLoading(!0),t=new x.a,a=n.props.imageToUpload[0],o=n.props.jsonToUpload,t.append("file",a),t.append("json_details",o),t.append("title",n.props.title),t.append("description",n.props.description),fetch("/upload-img-details",{method:"POST",body:t}).then(function(e){if(n.props.doneUploadToServer(),n.props.setLoading(!1),200===e.status)n.props.showDiag("Data uploaded successfully","success");else switch(e.status){case 400:n.props.showDiag("Failed to upload details - bad request params","error");break;case 409:n.props.showDiag("Failed to upload details - duplicate image entry","error");break;default:n.props.showDiag("Failed to upload details","error")}}).catch(function(e){n.props.doneUploadToServer(),n.props.setLoading(!1),console.error(e)}),n.handleClose();case 10:case"end":return e.stop()}},e)})),n.handleOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.state={open:!1},n}return Object(E.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(_.a,{variant:"contained",color:"default",className:"button_class",onClick:this.handleOpen},"Open Upload Form"),this.state.open&&this.props.showDiagComponent("Upload image details",o.a.createElement(L.a,null,o.a.createElement(j.a,null,o.a.createElement(y.a,{container:!0,spacing:2},o.a.createElement(y.a,{item:!0,xs:12,md:6},o.a.createElement(k.a,{fullWidth:!0,label:"Title",variant:"outlined",onChange:function(t){return e.handleTextChange(t,e.props.onTitleChange)}}),o.a.createElement(k.a,{fullWidth:!0,label:"Description",variant:"outlined",onChange:function(t){return e.handleTextChange(t,e.props.onDescriptionChange)}}),o.a.createElement(S,null),o.a.createElement(N,null)),o.a.createElement(y.a,{item:!0,xs:12,md:6},o.a.createElement(_.a,{variant:"contained",color:"primary",className:"button_class",onClick:this.uploadAllDetails},"Upload"))))),this.handleClose))}}]),a}(o.a.Component),P=Object(r.b)(function(e){var t=e.uploadState;return{imageToUpload:t.imageToUpload,jsonToUpload:t.jsonToUpload,title:t.title,description:t.description}},function(e){return{setLoading:function(t){e(s(t))},onTitleChange:function(t){e({type:"INPUT_TITLE",data:t})},onDescriptionChange:function(t){e({type:"INPUT_DESCRIPTION",data:t})},showDiag:function(t,a){e(c({title:t,closeBtn:"OK",mode:a}))},showDiagComponent:function(t,a,n){e(c({title:t,closeBtn:"Close",mode:"warning",descriptionComponent:a,onOkClick:function(){return n&&n()}}))},doneUploadToServer:function(){e({type:"UPLOAD_DATA_TO_SERVER"})}}})(A),B=(a(181),function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){return Object(v.a)(this,a),t.call(this,e)}return Object(E.a)(a,[{key:"render",value:function(){var e=this;if(console.log(this.props),!this.props.dialog)return o.a.createElement("div",null);var t=this.props.showDialog;this.props.dialog&&this.props.dialog.onOkClick&&(t=function(){e.props.showDialog(),e.props.dialog.onOkClick()});var a=this.props.showDialog;this.props.dialog&&this.props.dialog.onCancelClick&&(a=function(){e.props.showDialog(),e.props.dialog.onCancelClick()});var n="fa fa-check";return"error"===this.props.dialog.mode&&(n="fa fa-times"),"warning"===this.props.dialog.mode&&(n="fa fa-exclamation"),o.a.createElement("div",{className:"modal-dialog"},o.a.createElement("div",{className:"dialog-overlay ".concat(this.props.dialog?" show":"")},o.a.createElement("div",{className:"dialog-body ".concat(this.props.dialog&&"error"===this.props.dialog.mode?"error-dialog":"warning"===this.props.dialog.mode?"warning-dialog":"success-dialog")},this.props.dialog&&o.a.createElement("div",null,o.a.createElement("div",{className:"header-icon"},o.a.createElement("i",{className:n})),o.a.createElement("div",{className:"header"},this.props.dialog.title?this.props.dialog.title:""),o.a.createElement("div",{className:"description"},this.props.dialog.descriptionComponent?this.props.dialog.descriptionComponent:""),o.a.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:this.props.dialog.description?this.props.dialog.description:""}}),o.a.createElement("div",{className:"buttons"},this.props.dialog.closeBtn&&o.a.createElement("div",{className:"ok-btn action-button",type:"button",onClick:t},this.props.dialog.closeBtn),this.props.dialog.cancelBtn&&o.a.createElement("div",{className:"ok-btn",type:"button",onClick:a},this.props.dialog.cancelBtn))))))}}]),a}(o.a.Component)),R=Object(r.b)(function(e){return{dialog:e.appState.dialog}},function(e){return{showDialog:function(){e(c())}}})(B),F=a(350),G=a(341),H=a(157),W=a.n(H),z=function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}},J=function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){return Object(v.a)(this,a),t.call(this,e)}return Object(E.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{style:{zIndex:9999}},o.a.createElement(F.a,{className:z.backdrop,style:{zIndex:9999},open:this.props.isLoading},o.a.createElement(G.a,{color:"inherit"})))}}]),a}(n.Component),M=Object(l.d)(W()(z,{name:"BackdropSpinner"}),Object(r.b)(function(e){return{isLoading:e.appState.isLoading}}))(J),q=a(342),V=a(343),K=(a(203),a(204),function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){return Object(v.a)(this,a),t.call(this,e)}return Object(E.a)(a,[{key:"render",value:function(){var e=this;if(console.log(this.props),!this.props.dialog)return o.a.createElement("div",null);var t=this.props.showDialog;this.props.dialog&&this.props.dialog.onOkClick&&(t=function(){e.props.dialog.onOkClick()});var a=this.props.showDialog;this.props.dialog&&this.props.dialog.onCancelClick&&(a=function(){e.props.showDialog(),e.props.dialog.onCancelClick()});var n="fa fa-check";return"error"===this.props.dialog.mode&&(n="fa fa-times"),"warning"===this.props.dialog.mode&&(n="fa fa-exclamation"),o.a.createElement("div",{className:"modal-dialog"},o.a.createElement("div",{className:"dialog-overlay ".concat(this.props.dialog?" show":"")},o.a.createElement("div",{className:"dialog-body ".concat(this.props.dialog&&"error"===this.props.dialog.mode?"error-dialog":"warning"===this.props.dialog.mode?"warning-dialog":"success-dialog")},this.props.dialog&&o.a.createElement("div",null,o.a.createElement("div",{className:"header-icon"},o.a.createElement("i",{className:n})),o.a.createElement("div",{className:"header"},this.props.dialog.title?this.props.dialog.title:""),o.a.createElement("div",{className:"description"},this.props.dialog.descriptionComponent?this.props.dialog.descriptionComponent:""),o.a.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:this.props.dialog.description?this.props.dialog.description:""}}),o.a.createElement("div",{className:"buttons"},this.props.dialog.closeBtn&&o.a.createElement("div",{className:"ok-btn action-button",type:"button",onClick:t},this.props.dialog.closeBtn),this.props.dialog.cancelBtn&&o.a.createElement("div",{className:"ok-btn",type:"button",onClick:a},this.props.dialog.cancelBtn))))))}}]),a}(o.a.Component)),$=function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).handleShowDialog=function(){n.setState({isOpen:!n.state.isOpen}),console.log("clicked")},n.state={isOpen:!1},n}return Object(E.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{zIndex:10}},o.a.createElement("img",{src:this.props.path,onClick:this.handleShowDialog,alt:"no image",style:{width:"100%",height:"100%"}}),this.state.isOpen&&o.a.createElement(K,{dialog:{title:this.props.title,closeBtn:"Close",mode:"success",descriptionComponent:o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("h5",null,this.props.description)),o.a.createElement("img",{style:{width:"100%",height:"100%"},className:"image",src:this.props.polygon_path,onClick:this.handleShowDialog,alt:"no image"})),onOkClick:function(){return e.handleShowDialog()}}}))}}]),a}(o.a.Component),Q=a(59),X=Q.a().shape({image_path:Q.b().required(),image_path_polygon:Q.b().required(),category:Q.b().required(),"sub-category":Q.b().required()}),Y=(a(304),function(e){Object(O.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).pollServerImgCache=function(){console.log("Polling server cache every 5 seconds"),n.props.refreshCache().then(function(){return setTimeout(function(){n.props.refreshCache()},5e3)})},n.pollServerImgCache(),n}return Object(E.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"root"},o.a.createElement(q.a,{cellHeight:160,className:"gridList",cols:1},this.props.imagesCache.map(function(e){return o.a.createElement(V.a,{key:e._id,cols:e.cols||1},o.a.createElement(_.a,null,o.a.createElement($,{title:e.title,description:e.description,path:e.image_path.substring(1),polygon_path:e.image_path_polygon.substring(1)})))})))}}]),a}(n.Component)),Z=Object(r.b)(function(e){var t=e.appState;return{imagesCache:e.galleryState.imagesCache,isLoading:t.isLoading}},function(e){return{refreshCache:function(){return e(s(!0)),fetch("/get-list-of-images").then(function(e){return e?e.json():{images:[]}}).then(function(t){e(s(!1));var a=t.images.filter(function(e){return X.isValid(e)});e({type:"UPDATE_CACHE",imagesCache:a})}).catch(function(t){e(s(!1)),console.error(t)})},showDiag:function(t,a,n){e(c({title:t,closeBtn:"Close",mode:"success",descriptionComponent:a,onOkClick:function(){return n&&n()}}))}}})(Y),ee=a(47),te=a(161),ae=a(345),ne=a(346),oe=a(349),ie=a(347),re=a(344),le=a(351);function se(e){var t=e.children,a=e.value,n=e.index,i=Object(te.a)(e,["children","value","index"]);return o.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},i),a===n&&o.a.createElement(le.a,{p:3},o.a.createElement(re.a,null,t)))}var ce=Object(ae.a)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}});function pe(e){var t=e.listOfComponents,a=ce(),n=o.a.useState(0),i=Object(ee.a)(n,2),r=i[0],l=i[1];return o.a.createElement("div",{className:a.root},o.a.createElement(ne.a,{position:"static"},o.a.createElement(oe.a,{value:r,onChange:function(e,t){l(t)},"aria-label":"simple tabs example"},t.map(function(e){return o.a.createElement(ie.a,Object.assign({key:e.label,label:e.label},(t=e.index,{id:"simple-tab-".concat(t),"aria-controls":"simple-tabpanel-".concat(t)})));var t}))),t.map(function(e){return o.a.createElement(se,{key:e.label,value:r,index:e.index},e.component)}))}var de=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(pe,{listOfComponents:[{index:0,label:"Upload form",component:o.a.createElement(P,null)},{index:1,label:"Gallery",component:o.a.createElement(Z,null)}]}),o.a.createElement(R,null),o.a.createElement(M,null))},ue=Object(l.e)(m,Object(l.a)(g.a));Object(i.render)(o.a.createElement(r.a,{store:ue},o.a.createElement(de,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[167,1,2]]]);
//# sourceMappingURL=main.65cca473.chunk.js.map